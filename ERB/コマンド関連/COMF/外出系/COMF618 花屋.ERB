@COM618
#DIM 買うもの
;購入条件設定
FOR LOCAL, 0, 1000
	CALL ITEMDATA(LOCAL, "SHOP:花屋")
	IF RESULT
		CALL ITEMDATA(LOCAL, "SALES")
		ITEMSALES:LOCAL = RESULT
	ENDIF
NEXT
DRAWLINE
CALL LIST_ITEM("ローター")
CALL LIST_ITEM("野菜")
CALL LIST_ITEM("園芸用品")
DRAWLINE
PRINTFORML 購入するアイテムを選んでください（所持金:\\%TOSTR(MONEY,"#,###")%）
DRAWLINE
CALL SHOW_SHOPPING("花屋")
DRAWLINE
PRINTL [999] - 戻る
INPUT
IF RESULT == 999
	TIME += 10
	RETURN -1
ELSEIF RESULT == GETNUM(ITEM, "園芸用品一式") && ITEMSALES:RESULT >= 0
	CALL ITEMDATA(RESULT, "購入")
	SIF RESULT
		RESTART
ELSE
	買うもの = RESULT
	CALL ITEMDATA(買うもの, "SHOP:花屋")
	IF RESULT && ITEMSALES:買うもの >= 1 && ITEM:買うもの < 所持数制限
		CALL ITEMDATA(買うもの, "購入")
		SIF !RESULT
			RESTART
	ELSE
		RESTART
	ENDIF
ENDIF
TIME += 10

;-------------------------------------------------
;実行可能判定
;-------------------------------------------------
;花屋
@COM_ABLE618
;一括管理
SIF GLOBAL_COMABLE(618)
	RETURN RESULT

;花屋ではない場所
SIF !FLOWER_SHOP(CFLAG:MASTER:現在位置)
	RETURN 0
;睡眠中
SIF CFLAG:睡眠
	RETURN 0
;時間停止中
SIF FLAG:70
	RETURN 0
RETURN 1

;花屋を判定する関数
@FLOWER_SHOP(ARG)
#FUNCTION
;花屋
SIF ARG == GET_MAP_REPLACEMENT(215)
	RETURNF 1
RETURNF 0
