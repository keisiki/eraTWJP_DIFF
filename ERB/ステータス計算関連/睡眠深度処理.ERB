;FileName_SOURCE1.ERB ------------------------------ Rev1.00
;睡眠深度の減少処理
;ARG		キャラNO
;-----------------------------------------------------------
@睡眠深度減少(ARG)
SIF CFLAG:MASTER:イタズラ != 2
	RETURN

LOCAL:1 += CUP:ARG:不快 * 10 + CUP:ARG:苦痛 * 10 + CUP:ARG:恐怖 + CUP:ARG:反感 + CUP:ARG:抑鬱 / 2
SELECTCASE CUP:ARG:欲情
	CASE 50 TO 100
		LOCAL:1 += 50
	CASE 101 TO 500
		LOCAL:1 += 250
	CASE 501 TO 1000
		LOCAL:1 += 500
	CASE IS > 1000
		LOCAL:1 += 1000
	CASEELSE
ENDSELECT
;		PRINTFORM 睡眠深度基礎値{LOCAL:1}
SELECTCASE EXP:MASTER:睡眠姦経験
	CASE 100 TO 500
		LOCAL:1 -= 100
	CASE 501 TO 1000
		LOCAL:1 -= 250
	CASE IS > 1000
		LOCAL:1 -= 500
	CASEELSE
ENDSELECT
SELECTCASE EXP:TARGET:睡眠姦経験
	CASE 100 TO 500
		LOCAL:1 -= 100
	CASE 501 TO 1000
		LOCAL:1 -= 250
	CASE IS > 1000
		LOCAL:1 -= 500
	CASEELSE
ENDSELECT
LOCAL:1 = MAX(LOCAL:1, 0)
SIF TCVAR:TARGET:睡眠薬強度 == 1
		LOCAL:1 = LOCAL:1 / 2
SIF TCVAR:TARGET:睡眠薬強度 == 2
		LOCAL:1 = LOCAL:1 / 4
SIF TCVAR:TARGET:睡眠薬強度 == 3
		LOCAL:1 = 0
;PRINTFORM 睡眠深度が{LOCAL:1}減った
TCVAR:ARG:睡眠深度 -= LOCAL:1


;FileName_TRACHECK.ERB ----------------------------- Rev1.00
;好感度上昇計算処理
;CALL		USER
;ARG		0:キャラNO
;RETURN		VOID
;COMMENT	
;-----------------------------------------------------------
@睡眠姦発覚(ARG)
SIF TCVAR:ARG:睡眠薬強度 == 3 && 睡眠時間(ARG) || FLAG:70
	RETURN
;昏睡だと起きない

PRINTFORML %CALLNAME:ARG%が目を覚ました
IF !TEQUIP:TARGET:縄
;縄で縛っていない
	IF TALENT:ARG:恋慕
		PRINTFORML %CALLNAME:ARG%は乱れた衣服を確認すると呆れたように%CALLNAME:MASTER%を見つめた
		PRINTFORMW 服装を整えながら%CALLNAME:ARG%はほどほどにするようにと小言を言った…
		CFLAG:ARG:好感度 += ABL:ARG:欲望
		PRINTFORML 好感度＋{ABL:ARG:欲望}
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		CALL ENDUFUFU(ARG)
	ELSEIF TALENT:TARGET:セフレ || TALENT:TARGET:愛欲
		PRINTFORML %CALLNAME:ARG%は快感に目を覚ますと自分の体を獣のように貪る%CALLNAME:MASTER%をみとめた
		PRINTFORMW %CALLNAME:ARG%は淫靡なポーズをとりながらもっと可愛がって欲しいと%CALLNAME:MASTER%を誘っている…
		CFLAG:ARG:好感度 += ABL:ARG:欲望 * 2
		PRINTFORML 好感度＋{ABL:ARG:欲望 * 2}
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		FOR LOCAL, 1, GET_TARGETNUM() + 1
			CFLAG:(TARGET:LOCAL):うふふ = 1
		NEXT
	ELSE
		PRINTFORML %CALLNAME:ARG%は乱れた衣服を確認すると信じられないといった表情で%CALLNAME:MASTER%を睨んだ
		PRINTFORMW %CALLNAME:ARG%は怒りを滲ませた表情をしている……
		IF MARK:ARG:反発刻印 <= 2
			MARK:ARG:反発刻印 = 3
			PRINTFORML %CALLNAME:ARG%は憤怒に顔を歪ませて、恨み言を呟いている……
			SETCOLOR C_RED
			PRINTFORMW %CALLNAME:ARG%は反発刻印LV3を得た
			RESETCOLOR
		ENDIF
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		CALL ENDUFUFU(ARG)
	ENDIF
ELSE
;縄でしばってるならそのままヤッちゃう
	IF TALENT:ARG:恋慕
		PRINTFORML %CALLNAME:ARG%は目を覚ますと自分が縛られていることに気がついた
		PRINTFORMW %CALLNAME:MASTER%に気づくと呆れた表情でさっさと開放しなさいと言った…
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		FOR LOCAL,1, GET_TARGETNUM() + 1
			CFLAG:(TARGET:LOCAL):うふふ = 1
		NEXT
	ELSEIF TALENT:TARGET:セフレ || TALENT:TARGET:愛欲
		PRINTFORML %CALLNAME:ARG%は快感に目を覚ますと%CALLNAME:MASTER%が自分を縛って犯していることに気がついた
		PRINTFORMW %CALLNAME:ARG%は腰を振りながらもっと犯して欲しいと%CALLNAME:MASTER%を誘っている…
		CFLAG:ARG:好感度 += ABL:ARG:欲望 * 3
		PRINTFORML 好感度＋{ABL:ARG:欲望 * 3}
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		FOR LOCAL,1, GET_TARGETNUM() + 1
			CFLAG:(TARGET:LOCAL):うふふ = 1
		NEXT
	ELSE
		PRINTFORML %CALLNAME:ARG%が目を覚ますと%CALLNAME:MASTER%に縛られて犯されていることに気がついた
		IF TALENT:TARGET:度胸 < 0
			PRINTFORMW %CALLNAME:ARG%は泣きながら止めるように懇願している……
		ELSE
			PRINTFORMW %CALLNAME:ARG%は怒りを滲ませた表情で%CALLNAME:MASTER%を罵っている……
		ENDIF
		IF MARK:ARG:反発刻印 <= 2
			MARK:ARG:反発刻印 = 3
			PRINTFORM %CALLNAME:ARG%は
			IF TALENT:ARG:度胸 < 0
				PRINTFORM 泣きながら
			ELSE
				PRINTFORM 憤怒に顔を歪ませて、
			ENDIF
			PRINTFORML 恨み言を呟いている……
			SETCOLOR C_RED
			PRINTFORMW %CALLNAME:ARG%は反発刻印LV3を得た
			RESETCOLOR
		ENDIF
		CALL CHARA_AWAKE(ARG,1,1)
		CALL SET_PRANK(0,ARG,2)
		FOR LOCAL,1, GET_TARGETNUM() + 1
			CFLAG:(TARGET:LOCAL):うふふ = 1
		NEXT
		TCVAR:ARG:無理矢理 = 1
	ENDIF
ENDIF
CFLAG:ARG:眠姦発覚 = 1

