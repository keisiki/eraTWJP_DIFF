2018/05/05
eraTW4.590proto用バグ修正02


◆説明
>>528の修正が意外と楽勝だったので早めにリリース
ついでに集合.ERBのリファクタリング
集合って実績必要なコマンドになったんすね



◆対象環境
eraTW4.590protoのバニラ環境、もしくは以下のパッチのみを適用している場合には
そのまま上書きが可能です（変更内容をマージしてあります）
これ以外のパッチとの相性は不明

・[eraT0010542]eraTW4.590proto用TARGET変動修正
・[eraT0010543]eraTW4.590proto用バグ修正01



◆変更内容
・正しくないOR条件分岐の修正（>>528）
修正対象となった口上は霊夢、文、ルナサ、たらこフラン
ライセンス上、バグ修正に制限が無かったためUPしときます
そして正規表現検索したらCOMFも引っかかった
・集合コスト計算を勝手にリファクタリング
@SYUGOS_COSTの同一地点キャラの検索処理をばっさりしました
これは負荷軽減のための処理のはず（コスト算出回数自体は減ってる）だが全キャラで同一地点キャラの検索処理を行うのは重い
RETURNやCONTINUEによるスキップがあるとはいえ、判定は発生してその時点で負荷になる
ここの処理のせいでキャラの現在位置が分散していればしているほどキャラ数二乗計算に近づくので改良
多少軽くなったと思いたい（実感無いかも）
地点別に算出済み移動コストを記録しておけば、キャラループで検索する必要はないよねってだけです
ま、FINDELEMENTの性能次第ではある



◆残ってるバグ
・>>387、COMFの洗いなおし



◆そのほか
・睡眠姦強化したい？
あいかわらず動作テスト棚上げ中

・お漏らしにフェティシズムは感じないが
利尿剤強化の人の地の文はよく出来てると思う
羞恥がポイントなんだなやっぱ
エロいよ

・FINDELEMENTの第四引数
個人的なおぼえがき
FINDELEMENTの第四引数は検索範囲の終値+1を指定するものであり
　SIF FINDELEMENT(FLAG, 3, 0, 0)
このような場合、検索範囲に該当しうる要素がそもそも存在しないがエラーを吐かないで-1が返ってくる

・INRANGEとINRANGEARRAYの仕様の違い
個人的なおぼえがき
SIF INRANGE(HOGE, 0, 100)
　検索範囲に100は「含まれる」
SIF INRANGEARRAY(HOGE, 0, 100, 0, 100)
　検索範囲に100は「含まれない」
FINDELEMENTと同様に内部的にループやってそうな網羅的な検索処理は
FOR-NEXTのように「終値として渡した数値自体は含まれない」って理解でいいのかこれは？



◆つくったひと：morph
・morphのつくった以外のところの扱いはつくったひとに聞いて下さい
・配布・改造・流用、好きにしてください
・でも、その際のサポートは自分でやってね

※　era＝R-18全般の常識的な取り扱いとして例えば以下のような事はやめて下さい

・未成年者がいっぱいいる場所で広める
・R-18以外のモノをメインに扱ってる場所で取り上げる
