2018/05/05
eraTW4.590proto用バグ修正01


◆説明
お久しぶりです
バグ修正のついでに微妙に機能拡張したパッチ
集合.ERBのリファクタリングもしたかったが気力切れである



◆対象環境
eraTW4.590protoのバニラ環境、もしくは以下のパッチのみを適用している場合には
そのまま上書きが可能です（変更内容をマージしてあります）
これ以外のパッチとの相性は不明

・[eraT0010542]eraTW4.590proto用TARGET変動修正



◆変更内容
・宴会関連の表示の不具合修正（>>545, >>546）
　ついでにリファクタリング、全キャラループ中の分岐処理を微妙に変更
・守谷くじで特賞当選後、くじ箱を交換する際に表示されてない番号を入力すると無限ループに陥るバグ修正（>>549）
・衣玖さんの職場修正（>>702）天界拠点マップ化に伴う仕様変更として衣玖さん、屠自古さん、雷鼓さんの職場をとりあえず830に
・SOURCE計算時にTARGETが切り替わってしまっているバグ（>>696）はスルー、と思ったらさもまさんが修正してくれたんでマージ（eraT0010542）
・式中関数@MAP_AREANAME(PLACE_ID)を勝手に追加
　地点IDを渡すことでその地点がどこの敷地内か返す関数
　拠点が博麗神社である場合に
　MAP_AREANAME(13)なら"博麗神社"、MAP_AREANAME(30)なら"三妖精の家"、MAP_AREANAME(38)なら"夢幻遺跡"が返ってくる
　なお、拠点が博麗神社でない場合には
　MAP_AREANAME(30)なら"博麗神社"、MAP_AREANAME(50)なら"三妖精の家"、MAP_AREANAME(60)なら"夢幻遺跡"
　いろいろと使い道はあると思われます
・合わせて、式中関数として@AREANAME_CHARA_HOME(C_ID)と@AREANAME_CHARA_NOW(C_ID)を勝手に追加
　それぞれ、渡されたキャラの初期位置と現在位置のMAP_AREANAMEを返します
・式中関数@GET_CHARAHOME(CHARA)で初期位置のCSV設定値を返していたのを現在値に修正



◆残ってるバグ
・>>387、COMFの洗いなおし
・>>528、正しくないOR条件分岐



◆そのほか
・睡眠姦強化したい？
前のパッチのリドミみてて思い出した
旧verでこんな塩梅やろって構文だけ書き上げて、てすとしてないわ！



◆つくったひと：morph
・morphのつくった以外のところの扱いはつくったひとに聞いて下さい
・配布・改造・流用、好きにしてください
・でも、その際のサポートは自分でやってね

※　era＝R-18全般の常識的な取り扱いとして例えば以下のような事はやめて下さい

・未成年者がいっぱいいる場所で広める
・R-18以外のモノをメインに扱ってる場所で取り上げる
