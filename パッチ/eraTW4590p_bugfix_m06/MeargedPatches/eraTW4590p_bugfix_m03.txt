2018/05/06
eraTW4.590proto用バグ修正03


◆説明
出来る範囲でバグ修正
1匹見つけたら5匹くらい出てくるな



◆対象環境
eraTW4.590protoのバニラ環境、もしくは以下のパッチのみを適用している場合には
そのまま上書きが可能です（変更内容をマージしてあります）
これ以外のパッチとの相性は不明

・[eraT0010542]eraTW4.590proto用TARGET変動修正
・[eraT0010543]eraTW4.590proto用バグ修正01
・[eraT0010545]eraTW4.590proto用バグ修正02



◆変更内容
・体力の自然消費処理において睡眠不足判定の挙動がおかしかったのを修正（>>726）
　ついでにTFLAGのリセットをVARSETに変更、よっぽどバグにはつながらないとは思うが
　このご時世にREPEATはやめようと思いました
　試しにGREPしたら口上などに数カ所REPEAT残ってるが変えたほうがいいだろうかねぇ
・デート中の[697]部屋を訪ねるコマンドで家主の名前が二重表示されるのを修正（>>732）
　ちょっと削っただけです
・夢精イベントでMASTERや同マップの同居していないキャラが呼び出されるバグの修正（>>731）
　不適切なキャラを弾く処理が甘かったっぽい
　多少はマシになったと思いたい
・依頼処理の仕様変更（>>736）
　COMでRETURN 1しないとSOURCE処理に移れないらしいので正の数をRETURNするように
　仕様変更にともなって全ての依頼の書き直し、ドキュメントも更新
・山頂マップの追加に伴って@RAND_PLACE(ARG, TYPE)を変更
　落とし物依頼の発生時等に山頂マップ対象だとバグってた
・モブ娘処理の変更
　CSTR:10を使うのが微妙にヤバげだったのでCSTR:15に変更
　モブ娘のプロフィール処理が上手く動いてなかったのを修正、やっつけだが最低限の表示はされるように
　フレーバーテキストのバリエーション追加、人妻追加（したが経験系をいじってないのであまりそれっぽくはない）
　フレーバーは追加するなりざっくり切り捨てるなりしてください
・CSVのコメント追加
　口上用変数について、TCVAR/CFLAGのCSV側に範囲の記述がなかったのでコメント追加
　あと今回、CSTRの仕様によるバグも見つかったんでそちらもコメント追加
・一部のデバッグ機能がタイポで機能していなかったのを修正
　[IF DEBUG]→[IF_DEBUG]です
・@SCHEDULEに機能追加？
　デバッグ用の関数呼び出しボタンをつけただけ
　PRINT系のWAIT調整などにもどうぞ
　各拠点で延々と夢精イベントを起こして不適切なキャラが呼び出されないかチェックするのに使った
　人里と地底の旧都は判定がザルい、けどこれ以上変えるの面倒だ



◆残ってるバグ
・>>387、COMFの洗いなおし
・>>558,758、複数押し倒され時にTARGETの変更がうまく動かなくなるバグ
・懸念：MASTERのCFLAG:神社在住
　初日に神社以外でスタートして三妖精の家の地下室に引っ越したらCFLAG:MASTER:神社在住の数値が55になってる
　これが正しい挙動なのかどうかが判断できない
　@DAIRY_EV2の挙動おかしい→@GET_CHARAHOMEの挙動おかしいで変数ウォッチしてたら気づいたんだけど
　とりあえずGET_CHARAHOMEはMASTER専用処理で挙動を修正した
　他の箇所で不具合出てるかどうかは知らない



◆そのほか
・睡眠姦強化したい？
あいかわらず動作テスト棚上げ中

・@COMxx内でのRETURN
個人的なおぼえがき
COMxx内でのRETURNは1以上を返さないとSOURCE系の処理を通らない
書いてて思ったが、こりゃeraTWがどうのっていうよりは
erabasicのtrainの仕様だろうな
さもまさんありがとう



◆つくったひと：morph
・morphのつくった以外のところの扱いはつくったひとに聞いて下さい
・配布・改造・流用、好きにしてください
・でも、その際のサポートは自分でやってね

※　era＝R-18全般の常識的な取り扱いとして例えば以下のような事はやめて下さい

・未成年者がいっぱいいる場所で広める
・R-18以外のモノをメインに扱ってる場所で取り上げる
